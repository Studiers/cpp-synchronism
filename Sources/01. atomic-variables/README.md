# Atomic Variables

```cpp
...
#include <atomic>
...
```

## 원자계

멀티스레딩 환경에서 작업을 진행할때 신경써야하는 것은 `공유자원에 대한 처리`입니다

두개 이상의 스레드에서 한 변수(자원)에 동시접근하여 수정하려고 할 때 `데이터레이스` 문제가 일어나게 됩니다

이를 방지하기 위해 뮤텍스나 스핀락 같은 락으로 경쟁상태를 방지하고는 합니다. 하지만 CPP에서는 atomic이라는 헤더내에 원자계 연산을 넣어놓았더군요

원자계 연산은 CPU(하드웨어) 단에서 명령어로써 처리해주거나 컴파일러 자체로 구현해놓은 경우가 있습니다. 책에서는 자료형의 바이트 크기에 따라서 **CPU 명령어**을 사용할 것인지 **컴파일러의 구현**(책의 경우 스핀락)을 따를 것인지가 달라진다고 하는데 내 경우에는 그냥 자체 구현으로 넘어가길래 그냥 뭐지하고 넘기기로 했다

아무튼 원자계 연산이란건 경쟁상태의 원인이 되는 fetch(load) and write를 분리하지 않고 하나의 연산으로 처리하는 것이다 (*내가 이해한 것은 그렇다, 문제가 있다면 알려주시면 감사하겠습니다*)

이를 구현하기 위해 std::atomic 자료형이 있는 것이고 이에 더불어 memory-ordering에 대해서도 공부해야한다, 그건 다음 디렉토리에 정리하려고 한다